<!DOCTYPE html>
<html lang="en" id="htmlRoot" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OMOLLO TECH INC - Vehicle Dashboard</title>
  <script>
    tailwind.config = {
      darkMode: 'class'
    };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-gray-100 dark:bg-gray-900 dark:text-white min-h-screen">
  <header class="bg-white dark:bg-gray-800 shadow p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">OMOLLO TECH INC </h1>
    <button onclick="toggleDarkMode()" class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded">
      Toggle Dark
    </button>
  </header>

  <!-- Summary Cards -->
  <div class="p-4 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow text-center">
      <h2 class="text-lg font-semibold">Total Vehicles</h2>
      <p class="text-3xl font-bold" id="totalVehicles">0</p>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow text-center">
      <h2 class="text-lg font-semibold">Active Vehicles</h2>
      <p class="text-3xl font-bold" id="activeVehicles">0</p>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow text-center">
      <h2 class="text-lg font-semibold">In Maintenance</h2>
      <p class="text-3xl font-bold" id="maintenanceVehicles">0</p>
    </div>
  </div>

  <!-- Filter + Chart -->
  <div class="p-4 flex flex-col lg:flex-row gap-6">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow w-full lg:w-2/3">
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <input id="searchInput" type="text" placeholder="Search..."
          class="px-4 py-2 border rounded bg-white dark:bg-gray-700 dark:text-white" />
        <select id="filterType"
          class="px-4 py-2 border rounded bg-white dark:bg-gray-700 dark:text-white">
          <option value="">Filter by Type</option>
          <option value="Car">Car</option>
          <option value="Truck">Truck</option>
          <option value="Van">Van</option>
        </select>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow w-full lg:w-1/3">
      <h2 class="text-lg font-semibold mb-2">Vehicle Classification</h2>
      <canvas id="classificationChart" class="w-full h-40"></canvas>
    </div>
  </div>

  <!-- Add Vehicle Button -->
  <div class="p-4">
    <button onclick="toggleAddModal()"
     class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">+ Add Vehicle</button>
    <!-- ‚úè Edit Modal -->
<div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center z-50">
  <div class="bg-white dark:bg-gray-800 p-6 rounded-lg w-full max-w-md shadow">
    <h2 class="text-xl font-semibold mb-4">Edit Vehicle</h2>
    <form id="editVehicleForm" class="space-y-4">
      <input id="editVehicleName" type="text" placeholder="Vehicle Name"
        class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white" />
      <select id="editVehicleType"
        class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white">
        <option value="Car">Car</option>
        <option value="Truck">Truck</option>
        <option value="Van">Van</option>
      </select>
      <select id="editVehicleStatus"
        class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white">
        <option value="Active">Active</option>
        <option value="In Maintenance">In Maintenance</option>
      </select>
      <input id="editVehicleFuel" type="number" placeholder="Fuel Level"
        class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white" />
      <div class="flex justify-end gap-3">
        <button type="button" onclick="toggleEditModal()" class="bg-gray-500 text-white px-4 py-2 rounded">Cancel</button>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Update</button>
      </div>
    </form>
  </div>
</div>
     
  </div>

  <!-- Vehicle Table -->
  <div class="p-4 bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="bg-gray-200 dark:bg-gray-700">
          <th class="text-left px-4 py-2">Name</th>
          <th class="text-left px-4 py-2">Type</th>
          <th class="text-left px-4 py-2">Status</th>
          <th class="text-left px-4 py-2">Fuel</th>
          <th class="text-left px-4 py-2">Actions</th>
        </tr>
      </thead>
      <tbody id="vehicleTableBody"></tbody>
    </table>
  </div><!-- Add Vehicle Modal -->
  <div id="addModal" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center z-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg w-full max-w-md shadow">
      <h2 class="text-xl font-semibold mb-4">Add Vehicle</h2>
      <form id="addVehicleForm" class="space-y-4">
        <input id="vehicleName" type="text" placeholder="Vehicle Name"
          class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white" />
        <select id="vehicleType"
          class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white">
          <option value="">Select Type</option>
          <option value="Car">Car</option>
          <option value="Truck">Truck</option>
          <option value="Van">Van</option>
        </select>
        <select id="vehicleStatus"
          class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white">
          <option value="">Select Status</option>
          <option value="Active">Active</option>
          <option value="In Maintenance">In Maintenance</option>
        </select>
        <input id="vehicleFuel" type="number" placeholder="Fuel Level"
          class="w-full border px-3 py-2 rounded bg-white text-gray-800 dark:bg-gray-700 dark:text-white" />
        <div class="flex justify-end gap-3">
          <button type="button" onclick="toggleAddModal()"
            class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Cancel</button>
          <button type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    const root = document.getElementById("htmlRoot");
    const addModal = document.getElementById("addModal");
    const addForm = document.getElementById("addVehicleForm");

    // üåó Dark Mode Toggle
    function toggleDarkMode() {
      root.classList.toggle("dark");
      localStorage.setItem("theme", root.classList.contains("dark") ? "dark" : "light");
    }

    // üö™ Toggle Add Modal
    function toggleAddModal() {
      addModal.classList.toggle("hidden");
      addModal.classList.toggle("flex");
    }

    // üöó Load Vehicles from Storage
    function loadVehicles() {
      const vehicles = JSON.parse(localStorage.getItem("vehicles")) || [];
      const tbody = document.getElementById("vehicleTableBody");
      tbody.innerHTML = "";

      let total = 0, active = 0, maintenance = 0;
      const typeCount = { Car: 0, Truck: 0, Van: 0 };

      vehicles.forEach((v, index) => {
        tbody.innerHTML += `
          <tr class="border-b dark:border-gray-700">
            <td class="px-4 py-2">${v.name}</td>
            <td class="px-4 py-2">${v.type}</td>
            <td class="px-4 py-2">${v.status}</td>
            <td class="px-4 py-2">${v.fuel}</td>
           <td class="px-4 py-2 flex gap-2">
  <button onclick="editVehicle(${index})" title="Edit" class="text-blue-500">‚úè</button>
  <button onclick="deleteVehicle(${index})" title="Delete" class="text-red-500">‚ùå</button>
</td>
            </td>
          </tr>
        `;
        total++;
        if (v.status === "Active") active++;
        if (v.status === "In Maintenance") maintenance++;
        if (v.type) typeCount[v.type]++;
      });

      document.getElementById("totalVehicles").innerText = total;
      document.getElementById("activeVehicles").innerText = active;
      document.getElementById("maintenanceVehicles").innerText = maintenance;
      updateChart(typeCount);
    }

    // üíæ Add Vehicle Logic
    addForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const name = document.getElementById("vehicleName").value;
      const type = document.getElementById("vehicleType").value;
      const status = document.getElementById("vehicleStatus").value;
      const fuel = document.getElementById("vehicleFuel").value;

      if (!name || !type || !status || !fuel) return alert("Please fill all fields");

      const vehicles = JSON.parse(localStorage.getItem("vehicles")) || [];
      vehicles.push({ name, type, status, fuel });
      localStorage.setItem("vehicles", JSON.stringify(vehicles));

      addForm.reset();
      toggleAddModal();
      loadVehicles();
    });

    // ‚ùå Delete
    function deleteVehicle(index) {
      const vehicles = JSON.parse(localStorage.getItem("vehicles")) || [];
      vehicles.splice(index, 1);
      localStorage.setItem("vehicles", JSON.stringify(vehicles));
      loadVehicles();
    }

    // üìä Chart
    let chart;
    function updateChart(data) {
      const ctx = document.getElementById("classificationChart").getContext("2d");
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: "doughnut",
        data: {
          labels: Object.keys(data),
          datasets: [{
            data: Object.values(data),
            backgroundColor: ["#3B82F6", "#F59E0B", "#10B981"]
          }]
        },
        options: {
          plugins: {
            legend: { labels: { color: root.classList.contains("dark") ? "#fff" : "#000" } }
          }
        }
      });
    }

    // üîç Filter/Search
    document.getElementById("searchInput").addEventListener("input", loadVehicles);
    document.getElementById("filterType").addEventListener("change", loadVehicles);

    // ‚è± Auto-load
    window.onload = () => {
      if (localStorage.getItem("theme") === "dark") root.classList.add("dark");
      loadVehicles();
    };
    let currentEditIndex = null;

function toggleEditModal(show = false) {
  const modal = document.getElementById("editModal");
  if (show) {
    modal.classList.remove("hidden");
    modal.classList.add("flex");
  } else {
    modal.classList.add("hidden");
    modal.classList.remove("flex");
  }
}

function editVehicle(index) {
  const vehicles = JSON.parse(localStorage.getItem("vehicles")) || [];
  const v = vehicles[index];
  currentEditIndex = index;

  document.getElementById("editVehicleName").value = v.name;
  document.getElementById("editVehicleType").value = v.type;
  document.getElementById("editVehicleStatus").value = v.status;
  document.getElementById("editVehicleFuel").value = v.fuel;

  toggleEditModal(true);
}

// ‚úÖ Handle submit
document.getElementById("editVehicleForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const name = document.getElementById("editVehicleName").value;
  const type = document.getElementById("editVehicleType").value;
  const status = document.getElementById("editVehicleStatus").value;
  const fuel = document.getElementById("editVehicleFuel").value;

  const vehicles = JSON.parse(localStorage.getItem("vehicles")) || [];
  vehicles[currentEditIndex] = { name, type, status, fuel };
  localStorage.setItem("vehicles", JSON.stringify(vehicles));

  toggleEditModal(false);
  loadVehicles(); // üí• Table + Chart update
});
  </script>
</body>
</html>